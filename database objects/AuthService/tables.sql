CREATE TABLE USERS (
    ID              NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    USERNAME        VARCHAR2(100) UNIQUE NOT NULL,
    PASSWORD        VARCHAR2(255) NOT NULL,
    EMAIL           VARCHAR2(150),
    ENABLED         NUMBER(1) DEFAULT 1,
    ACCOUNT_LOCKED  NUMBER(1) DEFAULT 0,
    CREATED_AT      TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);


CREATE TABLE ROLES (
    ID      NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    NAME    VARCHAR2(100) UNIQUE NOT NULL,
    DESCRIPTION VARCHAR2(255)
);

CREATE TABLE PERMISSIONS (
    ID      NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    NAME    VARCHAR2(150) UNIQUE NOT NULL,
    DESCRIPTION VARCHAR2(255)
);

CREATE TABLE USER_ROLES (
    USER_ID NUMBER NOT NULL,
    ROLE_ID NUMBER NOT NULL,
    PRIMARY KEY (USER_ID, ROLE_ID),
    FOREIGN KEY (USER_ID) REFERENCES USERS(ID),
    FOREIGN KEY (ROLE_ID) REFERENCES ROLES(ID)
);

CREATE TABLE ROLE_PERMISSIONS (
    ROLE_ID       NUMBER NOT NULL,
    PERMISSION_ID NUMBER NOT NULL,
    PRIMARY KEY (ROLE_ID, PERMISSION_ID),
    FOREIGN KEY (ROLE_ID) REFERENCES ROLES(ID),
    FOREIGN KEY (PERMISSION_ID) REFERENCES PERMISSIONS(ID)
);